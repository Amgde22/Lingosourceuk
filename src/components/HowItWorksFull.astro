---
import { t } from "i18n:astro";
import FormSvg from "../icons/form.svg?raw";
import BlueprintSvg from "../icons/blueprint.svg?raw";
import TeamSvg from "../icons/people.svg?raw";
import GoLiveSvg from "../icons/rocket.svg?raw";
---
<div class="place-taker" ></div>

<section class="how-it-works">
  <!-- BACKGROUND ELEMENT: Flowing Line SVG -->
  <svg class="background-line" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600" preserveAspectRatio="none">
    <path d="M-200,300 Q400,500 800,300 T 1400, 300" stroke="currentColor" stroke-width="120" fill="none" />
  </svg>

  <div class="container">
    <header class="header">
      <h2 class="header__title">{t("home:howItWorksPage.title")}</h2>
      <p class="header__subheading">{t("home:howItWorksPage.subheading")}</p>
      <div class="header__intro">
        {t("home:howItWorksPage.intro", { returnObjects: true }).map(
          (line) => (
            <p>{line}</p>
          )
        )}
      </div>
    </header>

    <div class="steps-wrapper">
      <!-- Step 1 -->
      <div id="step1" class="step-row">
        <div class="text-box">
          <h3 class="text-box__title">
            {t("home:howItWorksPage.step1.title")}
          </h3>
          <ul class="text-box__body">
            {t("home:howItWorksPage.step1.body", { returnObjects: true }).map(
              (item) => (
                <li set:html={item} ></li>
              )
            )}
          </ul>
        </div>
        <div class="decoration">
          <div class="decoration__circle"></div>
          <div class="decoration__icon" set:html={FormSvg} />
        </div>
      </div>

      <!-- Step 2 -->
      <div id="step2" class="step-row">
        <div class="text-box">
          <h3 class="text-box__title">
            {t("home:howItWorksPage.step2.title")}
          </h3>
          <ul class="text-box__body">
            {t("home:howItWorksPage.step2.body", { returnObjects: true }).map(
              (item) => (
                <li set:html={item}></li>
              )
            )}
          </ul>
        </div>
        <div class="decoration">
          <div class="decoration__circle"></div>
          <div class="decoration__icon" set:html={BlueprintSvg} />
        </div>
      </div>

      <!-- Step 3 -->
      <div id="step3" class="step-row">
        <div class="text-box">
          <h3 class="text-box__title">
            {t("home:howItWorksPage.step3.title")}
          </h3>
          <ul class="text-box__body">
            {t("home:howItWorksPage.step3.body", { returnObjects: true }).map(
              (item) => (
                <li set:html={item}></li>
              )
            )}
          </ul>
        </div>
        <div class="decoration">
          <div class="decoration__circle"></div>
          <div class="decoration__icon" set:html={TeamSvg} />
        </div>
      </div>

      <!-- Step 4 -->
      <div id="step4" class="step-row">
        <div class="text-box">
          <h3 class="text-box__title">
            {t("home:howItWorksPage.step4.title")}
          </h3>
          <ul class="text-box__body">
            {t("home:howItWorksPage.step4.body", { returnObjects: true }).map(
              (item) => (
                <li set:html={item}></li>
              )
            )}
          </ul>
        </div>
        <div class="decoration">
          <div class="decoration__circle"></div>
          <div class="decoration__icon" set:html={GoLiveSvg} />
        </div>
      </div>
    </div>

    <div class="cta-section">
      <div class="cta-section__ready-text">
        {t("home:howItWorksPage.ready", { returnObjects: true }).map(
          (line) => (
            <p set:html={line}></p>
          )
        )}
      </div>
      <a href="#" class="cta-section__cta-button"
        >{t("home:howItWorksPage.cta")}</a
      >
      <p class="cta-section__no-commitment">
        {t("home:howItWorksPage.noCommitment")}
      </p>
    </div>
  </div>
</section>

<style lang="less" scoped>


  .how-it-works {
    --bg-start: color-mix(in srgb, var(--primary) 13%, transparent);
    --bg-end: color-mix(in srgb, var(--primary) 16%, transparent);
    background: linear-gradient(to bottom, var(--bg-start), var(--bg-end));
    padding:3rem 0;
    overflow-x: hidden;
    position: relative; /* Set position context for pseudo-elements */
  }

#step1,
#step2,
#step3,
#step4{
  scroll-margin-top: 100px;
}
  .background-line {
      display: none; 
  }

  @media (min-width: 1024px) {
    .how-it-works {
      &::before, &::after {
        content: '';
        position: absolute;
        background-color: var(--primary);
        opacity: 0.04;
        z-index: 0;
        border-radius: 3rem;
      }
      &::before {
        width: 250px;
        height: 250px;
        top: 15%;
        left: 5%;
        transform: rotate(-25deg);
      }
      &::after {
        width: 350px;
        height: 350px;
        bottom: 10%;
        left: 8%;
        transform: rotate(15deg);
      }
    }
    .background-line {
      display: block;
      position: fixed;
      overflow: hidden;
      width: 250%;

      transform: translateX(-400px) rotate(90deg) ;
      color: var(--primary);

      opacity: 0.05;
      z-index: -100;
      animation: flow-animation 10s ease-in-out infinite alternate;
    }
  }




  .container {
    margin-inline: auto;
    position: relative; /* Ensure content stays above background elements */
    z-index: 2;
  }

  .header {
    max-width: 48rem;
    margin-inline: auto;
    margin-bottom: 4rem;

    &__title {
      font-size: 2.25rem;
      font-weight: 800;
      color: var(--gray-900);
      margin-bottom: 0.5rem;
    }
    &__subheading {
      font-size: 1.25rem;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 1.5rem;
    }
    &__intro {
      font-size: 1.125rem;
      color: var(--gray-700);
      line-height: 1.7;
      p {
        margin: 0;
      }
    }
  }

  .steps-wrapper {
    display: flex;
    flex-direction: column;

  }

  .step-row {
    display: grid;
    grid-template-columns: 1fr;
    align-items: center;
    position: relative;
    padding: 2.5rem 1.5rem;

    &:nth-child(even){
        background-color: color-mix(in srgb, var(--primary) 13%, transparent);

    }
  }

  .text-box {
    background: color-mix(in srgb, var(--gray-50) 85%, transparent);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.6);
    border-radius: 1.5rem;
    padding: 2.5rem;
    z-index: 2;
    width: 100%;

    &__title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gray-800);
      margin-bottom: 1.5rem;
    }

    &__body {
      padding-left: 1.5rem;
      list-style: none;
      color: var(--gray-600);
      margin: 0;

      li {
        position: relative;
        line-height: 1.8;
        padding-left: 0.5rem;

        &:not(:last-child) {
          margin-bottom: 0.75rem;
        }

        &::before {
          content: "â€¢";
          position: absolute;
          left: -1rem;
          color: var(--primary);
          font-weight: bold;
        }
      }
    }
  }

  .decoration {
    display: none; // Hidden on mobile
  }

  /* Desktop Styles */
  @media (min-width: 1024px) {
    .steps-wrapper {
      gap: 0;
    }
    .step-row {
      grid-template-columns: repeat(5, 1fr);
      gap: 2rem;
      padding-block: 2rem;
    }

    .text-box,
    .decoration {
      grid-row: 1; 
    }

    .decoration {
    margin:auto;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 300px;
      height: 300px;
      z-index: 1;

      &__circle {
        width: 100%;
        height: 100%;
        border: 6px dashed var(--primary);
        border-radius: 50%;
        animation: spin 45s linear infinite;
      }
      &__icon {
        position: absolute;
        color: color-mix(in srgb, var(--primary) 85%, white);

        :global(svg) {
          width: 128px;
          height: 128px;
        }
      }
    }

    /* Text on Left, Deco on Right */
    .step-row:nth-child(odd) {

      .text-box {
        grid-column: 1/ span 3;
      }
      .decoration {
        grid-column: 4 / -1;
        justify-self: start;
      }
    }

    /* Deco on Left, Text on Right */
    .step-row:nth-child(even) {
      .text-box {
        grid-column:  2 / -1;
      }
      .decoration {
        grid-column: 0 / span 3;
        justify-self: end;
      }
    }
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  .cta-section {
    text-align: center;
    margin-top: 5rem;
    &__ready-text {
      max-width: 38rem;
      margin-inline: auto;
      margin-bottom: 2rem;
      font-size: 1.25rem;
      color: var(--gray-800);
      line-height: 1.7;
      font-weight: 500;
      p {
        margin: 0;
      }
    }
    &__cta-button {
      background-color: var(--primary);
      color: white;
      padding: 1rem 3rem;
      border-radius: 0.5rem;
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      display: inline-block;
      transition: background-color 0.3s ease;

      &:hover {
        background-color: color-mix(in srgb, var(--primary) 90%, black);
      }
    }
    &__no-commitment {
      margin-top: 1rem;
      font-size: 0.875rem;
      color: var(--gray-600);
    }
  }
</style>